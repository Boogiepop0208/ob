[[统计学]]

**超几何分布 (Hypergeometric Distribution)**
#定义 
超几何分布是一种[[离散概率分布]]，它描述的是一个无放回的抽样过程。设想一个总体中有 \( N \) 个对象，其中 \( M \) 个对象被认为是“成功”，而其余 \( N - M \) 个对象被认为是“失败”。如果我们从这个总体中无放回地随机抽取 \( n \) 个对象，那么成功抽取 \( x \) 个“成功”对象的概率由超几何分布给出。

#formula 
其概率质量函数 (PMF) 定义为：
$$
P(X = x) = h(x; n, N, M) = \frac{\binom{M}{x} \binom{N-M}{n-x}}{\binom{N}{n}}
$$
其中 \( x \) 的取值范围为 \( \max(0, n - N + M) \) 到 \( \min(n, M) \)。

**例子及计算步骤**:

假设你有一个包含 20 张卡片的盒子，其中 8 张是红色的（即“成功”），12 张是蓝色的（即“失败”）。如果你从这盒子里随机抽取 5 张卡片，那么抽取到 3 张红色卡片的概率是多少？

在此例中：
- \( N = 20 \) (总卡片数)
- \( M = 8 \) (红色卡片数)
- \( n = 5 \) (抽取的卡片数)
- \( x = 3 \) (希望抽到的红色卡片数)

使用上述公式，所求的概率为：
$$
h(3;5, 20, 8) = \frac{\binom{8}{3} \binom{12}{2}}{\binom{20}{5}}
$$

具体计算为：

1. 从 8 张红色卡片中选 3 张的方法数：
$$ \binom{8}{3} = \frac{8!}{3!5!} = 56 $$

2. 从 12 张蓝色卡片中选 2 张的方法数：
$$ \binom{12}{2} = \frac{12!}{2!10!} = 66 $$

3. 从 20 张卡片中选 5 张的方法数：
$$ \binom{20}{5} = \frac{20!}{5!15!} = 15504 $$


将上述结果代入公式计算得到：
$$
h(3;5, 20, 8) = \frac{56 \times 66}{15504} \approx 0.23839
$$

因此，随机从盒子中抽取 5 张卡片得到 3 张红色卡片的概率约为 0.2378 或 23.78%。

假设 \( X \) 是一个具有参数 \( N \), \( M \), 和 \( n \) 的超几何随机变量。


**超几何分布 期望值和方差**
#formula 

1. **期望值 (Expected Value)**
超几何分布的期望值表示我们从总体中抽取 \( n \) 个样本时“成功”样本的平均数。其公式为：
$$
E(X) = \frac{nM}{N}
$$

解释：这基本上是按照总体中的成功比例来估算在抽样中应该有多少成功。

2. **方差 (Variance)**
超几何分布的方差表示在抽样中“成功”样本数的变异性或分散程度。其公式为：
$$
Var(X) =  \left (\frac{N-n}{N-1} \right) n \left( \frac{M}{N} \right)\left( 1-\frac{M}{N} \right)
$$

解释：这个公式实际上是在考虑各种因素，如成功的概率、失败的概率以及抽样比例，以及由于无放回抽样所产生的调整。


**例子**

Consider the experiment we conducted on the first day of class.

Students drew balls from a bag containing 18 white balls and 9 black balls and replaced them back in the bag each time.

Suppose that we conducted the same experiment as on the first day, but the balls were drawn without replacement. Let V represent the number of white balls drawn
on 10 draws.

a) Explain why we can no longer model the number of white balls drawn according to a binomial distribution

b) Explain why we can expect V to follow a hypergeometric distribution.

c) What is the probability that exactly 6 white balls are drawn?

d) What is the probability that 6 or fewer white balls are drawn?

e) What are the mean and variance of V?

- N（总球数）= 27 (18 白球 + 9 黑球)
- M（白球数）= 18
- n（抽取次数）= 10 (如题所述，进行了10次抽取)

a) 当我们在抽取球时是不放回的，那么每次抽取后，总的球数和白球的数量都会减少。由于每一次抽取都会影响下一次抽取的概率，因此事件不再是独立的。(Each draw will affect the probability of the next draw, so the events are no longer independent.)而二项分布需要满足两个条件：1) 每次试验只有两种可能的结果；2) 每次试验的成功概率都是固定的（即事件是独立的）。由于在不放回的情况下不满足第二个条件，所以不能使用二项分布来建模。

b) 超几何分布适用于从有限的、不放回的样本中抽取的情况。在这种情况下，我们关心的是从 \(N = 27\) 个球中抽取 \(n = 10\) 个球时，恰好得到 \(v\) 个白球的概率，这恰好是超几何分布的定义。

c) 抽出恰好6个白球的概率为：
$$ P(V = 6) = \frac{\binom{18}{6} \times \binom{9}{4}}{\binom{27}{10}} $$
![[Pasted image 20231010113304.png]]

d) 抽出6个或更少白球的概率是：
$$ P(V \leq 6) = \sum_{x=0}^{6} \frac{\binom{18}{x} \times \binom{9}{10-x}}{\binom{27}{10}} $$
![[Pasted image 20231010113318.png]]

e) 对于超几何分布：
- 均值为：
$$ E(V) = \frac{10 \times 18}{27} = \frac{180}{27} = 6.\overline{6} $$

- 方差为：
$$ \text{Var}(V) =  \left (\frac{27-10}{27-1} \right) \times 10 \left( \frac{18}{27} \right)\left( 1-\frac{18}{27} \right) $$

![[Pasted image 20231010113354.png]]


