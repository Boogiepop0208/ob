[[统计学]]
[[二项分布 负二项分布 区别]]

**负二项分布（Negative Binomial Distribution）**

负二项分布是一种[[离散概率分布]]，用于描述一系列独立且同分布的伯努利试验直到达到预定的成功次数所需的总试验次数。具体来说，如果一个实验满足以下条件：

1. 该实验由独立的重复试验组成。
2. 每次试验都有两种可能的结果，一般标记为“成功”（S）和“失败”（F）。
3. 成功的概率是一个常数，记作 \( p \)。
4. 试验会重复进行，直到发生 \( r \) 次成功。

在这种情况下，发生在第 \( r \) 次成功之前的失败次数遵循负二项分布。我们可以表示一个负二项随机变量(negative binomial random variable)为 \( X \)，其中 \( X \) 表示在第 \( r \) 次成功之前的失败次数。

那么，\( X \) 的[[概率质量函数]] (pmf) 为：
$$ P(X = x) =  nb(x; r, p) =\binom{r + x - 1}{r - 1} p^r (1-p)^x $$
其中，( x = 0,1,2, ...)。



**例子**

好的,使用另一种表达方式,该负二项分布概率计算问题可以表示为:

假设您正在投篮,并希望成功投中5次。每次您投篮的成功率为0.7(即 $p = 0.7$)。那么,假设 $X$ 代表在您成功投中第5次(即 $r = 5$)之前的失败次数,我们可以使用负二项分布来描述这一随机变量。

问题:在成功投中第5次之前,您失败了恰好2次的概率是多少?

使用负二项分布的公式:

$$P(X = x) = \binom{x+r-1}{r-1}p^r(1-p)^x$$

其中:

- $x$ - 第$r$次成功之前的失败次数  
- $r$ - 成功次数
- $p$ - 每次试验成功的概率

将给定条件代入公式:

- $x=2$,第5次成功之前失败2次  
- $r=5$,成功5次
- $p=0.7$,每次成功概率为0.7

带入公式可得:

$$P(X = 2) = \binom{2+5-1}{5-1}(0.7)^5(1-0.7)^2$$

$$P(X = 2) = \binom{6}{4}(0.7)^5(0.3)^2$$

$$P(X = 2) \approx 0.3087$$

可以看出,k表示第r次成功之前的失败次数,是负二项分布中的一个重要参数。



**两种公式表达 -- 对称性 -- k 可互换 r-1**

您提供的负二项分布概率质量函数公式是另一种等价的表达方式,与我之前给出的公式本质上是相同的:

我之前给出的公式:

$$P(X=k) = \binom{k+r-1}{k}p^r(1-p)^k$$

您提供的公式:

$$P(X=k) = \binom{k+r-1}{r-1}p^r(1-p)^k$$

这两个公式看起来形式不同,但实际上是等价的。原因在于二项式定理中的以下恒等式:

$$\binom{n}{k}=\binom{n}{n-k}$$

将这个恒等式应用到我之前的公式中:

$$\begin{aligned}
P(X=k) &= \binom{k+r-1}{k}p^r(1-p)^k\\
       &= \binom{k+r-1}{k+r-1-k}p^r(1-p)^k\\
       &= \binom{k+r-1}{r-1}p^r(1-p)^k
\end{aligned}$$

可以看出,应用二项式定理的恒等式后,我之前给出的公式转换成了您提供的等价形式。

因为在负二项分布概率质量函数公式中,把==k换成r-1是可以的,结果是一样的==。

具体来说,在以下公式中:

$$P(X=k) = \binom{k+r-1}{r-1}p^r(1-p)^k$$

把k换成r-1,公式变为:

$$P(X=r-1) = \binom{r-1+r-1}{r-1}p^r(1-p)^{r-1}$$

化简可得:

$$P(X=r-1) = \binom{2r-2}{r-1}p^r(1-p)^{r-1}$$

这与直接将k=r-1代入原公式:

$$P(X=r-1) = \binom{r-1+r-1}{r-1}p^r(1-p)^{r-1}$$

是完全一样的。

所以在负二项分布公式中, k和r-1可以互换使用, k表示第r次成功之前的失败次数,计算结果是一样的。这反映了它们在公式中的对称性。


**负二项分布 期望值和方差**

1. **期望值 (Expected Value)**

负二项分布的期望值表示第$r$次成功之前失败的平均次数。其公式为:

$$ E(X) = \frac{r(1-p)}{p} $$

期望值与成功次数$r$和每次试验成功概率$p$相关。当$r$增大或$p$减小时,期望值会增大。

2. **方差 (Variance)**

负二项分布的方差表示第$r$次成功之前失败次数的变异性。其公式为:

$$ Var(X) = \frac{r(1-p)}{p^2} $$

方差也与$r$和$p$相关。当$r$增大或$p$减小时,方差会增大。



**例题**

**Example 3.6**

Consider the experiment we conducted on the first day of class.

Students drew balls from a bag containing 18 white balls and 9 black balls and replaced them back in the bag each time.

Suppose that students drew balls with replacement（有放回的） until white balls had been drawn 20 times. Let $X$ be the number of black balls drawn.


*a) Explain why the binomial distribution and hypergeometric distribution are no longer appropriate.*
E：It' s with replacement so hypergeometric distribution is no longer appropriate. 

Cl:
- Binomial distribution requires fixed number of trials, but here the number of draws is random until 20 white balls are reached.
- Hypergeometric distribution models sampling without replacement, but here balls are sampled with replacement.
- 二项分布需要固定的试验次数，但在这里抽取的次数是随机的，直到达到20个白球为止.
- 超几何分布模拟无放回抽样，但在这里球是有放回地抽取的。

Prof:
The binomial and hypergeometric distributions are no longer appropriate because the number of trials is not fixed in advance.
二项式分布和超几何分布不再适用，因为试验次数事先没有固定。

*b) Explain why $X$ follows a negative binomial distribution.*
E： 
Because X means the number of black balls drawn. It would not end until drawn 20 white balls, which meets the requirements that trials are repeated until x successes occur. And it's with replcements.

Cl:
- $X$ counts failures (black balls) before the $r$-th success (20th white ball). This matches the setting of negative binomial distribution.
- The draws are Bernoulli trials with replacement, satisfying the assumptions.
- $X$ 计算在第 $r$ 次成功（第 20 个白球）之前的失败次数（黑球）。这符合负二项分布的设定。
- 抽取是具有替换(有放回)的伯努利试验，满足假设条件。

Prof:
We can assume that 𝐵 follows a negative binomial distribution because
i) The draws constitute independent trials.
ii) Each trial can result in one of two outcomes (white ball or black ball).
iii) The probability of drawing a white ball is fixed (𝑝 = 18/27).
iv) The experiment continues until 𝑟 = 20 white balls have been drawn.

我们可以假设𝐵服从负二项式分布，因为
i) 抽取是独立的试验。
ii) 每次试验有两种结果（白球或黑球）。
iii) 抽到白球的概率是固定的（𝑝 = 18/27）。
iv) 实验持续进行直到抽出20个白球。

*c) What is the probability that exactly 10 black balls are drawn before the 20th white ball?*
E:

Cl:
Let $r = 20$, $p =$ probability of drawing a white ball
$P(X = 10) = b(10; 20, p) = \binom{20-1}{10} * p^{20} * (1-p)^{10}$

Prof:
The probability of drawing exactly 10 black balls is

$$P(B = 10) = \binom{10 + 20 - 1}{20 - 1} \bigg(\frac{18}{27}\bigg)^{20} \bigg(1 - \frac{18}{27}\bigg)^{10} = 0.102.$$
- $B$ 是抽到的黑球数
- 使用负二项分布计算$B=10$的概率
- $r=20$是抽到的白球数
- $p=\frac{18}{27}$是抽到白球的概率
- 将给定条件代入负二项分布概率质量函数并计算即可得到概率0.102

*d) What are the mean and variance of $X$?*
E:
E(x) = 10
V(x) = 15

Prof:
The mean and variance of \( B \) are given by:

$$ E(B) = \frac{20(1 - 18/27)}{18/27} = 10 $$
and

$$ V(B) = \frac{20(1 - 18/27)}{(18/27)^2} = 15 $$


